# Что такое docker compose
## Оглавление
- [Определение](#определение)
- [Основные возможности](#основные-возможности)
- [Пример использования Docker Compose](#пример-использования-docker-compose)
- [Основные команды](#основные-команды)
- [Преимущества](#преимущества)
## Определение
Docker Compose — это инструмент для упрощения управления многоконтейнерными приложениями в Docker. С его помощью можно 
описывать конфигурации контейнеров, сети и тома, необходимые для работы приложения, в одном YAML-файле. Этот файл
называется docker-compose.yml. Docker Compose позволяет запускать, останавливать и управлять всеми контейнерами 
приложения как единое целое.
## Основные возможности
1. Управление многоконтейнерными приложениями - В одном docker-compose.yml файле можно описать несколько контейнеров,
которые взаимодействуют друг с другом, например, веб-сервер, база данных и кеш-сервер. Все эти контейнеры могут быть
запущены 1 командой
2. Декларативное описание конфигурации - В docker-compose.yml файле описывается конфигурация каждого сервиса 
(контейнера), включая его образ, переменные окружения, сети, тома, порты и другие параметры.
3. Лёгкость использования - С помощью простой команды docker-compose up можно запустить все контейнеры, описанные в 
файле. Эта команда автоматически поднимает нужные сети, тома и связывает контейнеры друг с другом.
4. Поддержка нескольких окружений - Можно легко переключаться между разными конфигурациями для разработки,
тестирования и продакшена, используя разные файлы конфигурации или переменные окружения.
5. Автоматическое решение зависимостей - Docker Compose автоматически запускает контейнеры в правильном порядке с учётом 
зависимостей. Например, если один контейнер зависит от работы другого (например, приложение зависит от базы данных), 
Compose запустит их в правильной последовательности.
## Пример использования Docker Compose
Рассмотрим пример docker-compose.yml файла, который поднимает простой веб-сервер на Nginx и базу данных PostgreSQL:
```yaml
version: '3.8'

services:
  web:
    image: nginx:latest
    ports:
      - "8080:80"
    volumes:
      - ./html:/usr/share/nginx/html
    networks:
      - mynetwork

  db:
    image: postgres:13
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
      POSTGRES_DB: mydb
    volumes:
      - dbdata:/var/lib/postgresql/data
    networks:
      - mynetwork

volumes:
  dbdata:

networks:
  mynetwork:
```
1. version: '3.8':
   - Версия спецификации Docker Compose. В данном случае используется версия 3.8, которая поддерживает новые функции, 
такие как конфигурации для нескольких окружений и сети.
2. services:
    - Секция, где определяются контейнеры (сервисы), которые необходимо запустить.
    - web:
      - Описывает сервис веб-сервера на базе Nginx.
      - image: nginx:latest — указывает образ для контейнера.
      - ports: "8080:80" — связывает порт 8080 на хосте с портом 80 в контейнере.
      - volumes — монтирует локальную директорию ./html в контейнере по пути /usr/share/nginx/html.
      - networks — связывает контейнер с пользовательской сетью mynetwork.
    - db:
      - Описывает сервис базы данных PostgreSQL.
      - image: postgres:13 — указывает образ PostgreSQL версии 13.
      - environment — задаёт переменные окружения для конфигурации базы данных.
      - volumes — монтирует том dbdata для хранения данных базы.
      - networks — подключает контейнер к сети mynetwork.
3. volumes:
   - Определяет именованный том dbdata, который будет использован для хранения данных PostgreSQL.
4. networks:
   - Создаёт пользовательскую сеть mynetwork, в которой будут взаимодействовать контейнеры web и db.
## Основные команды
- docker-compose up - Запускает все сервисы, определённые в docker-compose.yml, поднимает сети и монтирует тома. Если 
образы не существуют локально, они будут загружены с Docker Hub.
- docker-compose down - Останавливает и удаляет контейнеры, сети и тома, созданные командой up.
- docker-compose ps - Показывает список запущенных контейнеров, созданных Docker Compose.
- docker-compose logs - Выводит логи всех запущенных контейнеров.
- docker-compose exec - Позволяет выполнить команду внутри запущенного контейнера, аналогично docker exec.
## Преимущества
- Удобство развертывания - Одной командой можно поднять всю инфраструктуру приложения, что упрощает процесс
развертывания и разработки.
- Изоляция окружений - Разные окружения (например, разработка, тестирование и продакшен) могут использовать свои
собственные Docker Compose файлы или параметры, что облегчает управление конфигурациями.
- Простота масштабирования - Можно легко масштабировать отдельные сервисы командой
docker-compose up --scale <service>=<number>.
- Удобство управления - Compose предоставляет простой интерфейс для управления многоконтейнерными приложениями,
позволяя легко выполнять такие задачи, как мониторинг, логирование и обновление контейнеров.
